'use client';
"use strict";var e=require("tslib"),r=require("@headlessui/react"),t=require("react"),a=require("../../../assets/CalendarIcon.cjs"),o=require("../../../assets/XCircleIcon.cjs"),l=require("date-fns"),n=require("../../../lib/tremorTwMerge.cjs"),d=require("../selectUtils.cjs"),s=require("./dateRangePickerUtils.cjs"),u=require("../Calendar/Calendar.cjs");require("../Select/Select.cjs");var i=require("../Select/SelectItem.cjs"),m=require("date-fns/locale"),c=require("../../../hooks/useInternalState.cjs");function f(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var b=f(t);const p=l.startOfToday(),k=b.default.forwardRef(((f,k)=>{var g,v;const{value:w,defaultValue:h,onValueChange:y,enableSelect:x=!0,minDate:N,maxDate:E,placeholder:T="Select range",selectPlaceholder:M="Select range",disabled:S=!1,locale:D=m.enUS,enableClear:C=!0,displayFormat:q,children:j,className:O,enableYearNavigation:V=!1,weekStartsOn:P=0,disabledDates:F}=f,_=e.__rest(f,["value","defaultValue","onValueChange","enableSelect","minDate","maxDate","placeholder","selectPlaceholder","disabled","locale","enableClear","displayFormat","children","className","enableYearNavigation","weekStartsOn","disabledDates"]),[B,I]=c(h,w),[R,z]=t.useState(!1),[L,U]=t.useState(!1),Y=t.useMemo((()=>{const e=[];return N&&e.push({before:N}),E&&e.push({after:E}),[...e,...null!=F?F:[]]}),[N,E,F]),X=t.useMemo((()=>{const e=new Map;return j?b.default.Children.forEach(j,(r=>{var t;e.set(r.props.value,{text:null!==(t=d.getNodeText(r))&&void 0!==t?t:r.props.value,from:r.props.from,to:r.props.to})})):s.defaultOptions.forEach((r=>{e.set(r.value,{text:r.text,from:r.from,to:p})})),e}),[j]),A=t.useMemo((()=>{if(j)return d.constructValueToNameMapping(j);const e=new Map;return s.defaultOptions.forEach((r=>e.set(r.value,r.text))),e}),[j]),G=(null==B?void 0:B.selectValue)||"",H=s.parseStartDate(null==B?void 0:B.from,N,G,X),J=s.parseEndDate(null==B?void 0:B.to,E,G,X),K=H||J?s.formatSelectedDates(H,J,D,q):T,Q=l.startOfMonth(null!==(v=null!==(g=null!=J?J:H)&&void 0!==g?g:E)&&void 0!==v?v:p),W=C&&!S;return"development"===process.env.NODE_ENV&&console.info("The DateRangePicker is also available as a copy-and-paste component. Visit https://tremor.so/docs/inputs/date-range-picker (This is only shown in development)"),b.default.createElement("div",Object.assign({ref:k,className:n.tremorTwMerge("w-full min-w-[10rem] relative flex justify-between text-tremor-default max-w-sm shadow-tremor-input dark:shadow-dark-tremor-input rounded-tremor-default",O)},_),b.default.createElement(r.Popover,{as:"div",className:n.tremorTwMerge("w-full",x?"rounded-l-tremor-default":"rounded-tremor-default",R&&"ring-2 ring-tremor-brand-muted dark:ring-dark-tremor-brand-muted z-10")},b.default.createElement("div",{className:"relative w-full"},b.default.createElement(r.Popover.Button,{onFocus:()=>z(!0),onBlur:()=>z(!1),disabled:S,className:n.tremorTwMerge("w-full outline-none text-left whitespace-nowrap truncate focus:ring-2 transition duration-100 rounded-l-tremor-default flex flex-nowrap border pl-3 py-2","rounded-l-tremor-default border-tremor-border text-tremor-content-emphasis focus:border-tremor-brand-subtle focus:ring-tremor-brand-muted","dark:border-dark-tremor-border dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle dark:focus:ring-dark-tremor-brand-muted",x?"rounded-l-tremor-default":"rounded-tremor-default",W?"pr-8":"pr-4",d.getSelectButtonColors(d.hasValue(H||J),S))},b.default.createElement(a,{className:n.tremorTwMerge(s.makeDateRangePickerClassName("calendarIcon"),"flex-none shrink-0 h-5 w-5 -ml-0.5 mr-2","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle"),"aria-hidden":"true"}),b.default.createElement("p",{className:"truncate"},K)),W&&H?b.default.createElement("button",{type:"button",className:n.tremorTwMerge("absolute outline-none inset-y-0 right-0 flex items-center transition duration-100 mr-4"),onClick:e=>{e.preventDefault(),null==y||y({}),I({})}},b.default.createElement(o,{className:n.tremorTwMerge(s.makeDateRangePickerClassName("clearIcon"),"flex-none h-4 w-4","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle")})):null),b.default.createElement(r.Transition,{className:"absolute z-10 min-w-min left-0",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},b.default.createElement(r.Popover.Panel,{focus:!0,className:n.tremorTwMerge("divide-y overflow-y-auto outline-none rounded-tremor-default p-3 border my-1","bg-tremor-background border-tremor-border divide-tremor-border shadow-tremor-dropdown","dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border dark:shadow-dark-tremor-dropdown")},b.default.createElement(u,Object.assign({mode:"range",showOutsideDays:!0,defaultMonth:Q,selected:{from:H,to:J},onSelect:e=>{null==y||y({from:null==e?void 0:e.from,to:null==e?void 0:e.to}),I({from:null==e?void 0:e.from,to:null==e?void 0:e.to})},locale:D,disabled:Y,enableYearNavigation:V,classNames:{day_range_middle:n.tremorTwMerge("!rounded-none aria-selected:!bg-tremor-background-subtle aria-selected:dark:!bg-dark-tremor-background-subtle aria-selected:!text-tremor-content aria-selected:dark:!bg-dark-tremor-background-subtle"),day_range_start:"rounded-r-none rounded-l-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted",day_range_end:"rounded-l-none rounded-r-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted"},weekStartsOn:P},f))))),x&&b.default.createElement(r.Listbox,{as:"div",className:n.tremorTwMerge("w-48 -ml-px rounded-r-tremor-default",L&&"ring-2 ring-tremor-brand-muted dark:ring-dark-tremor-brand-muted z-10"),value:G,onChange:e=>{const{from:r,to:t}=X.get(e),a=null!=t?t:p;null==y||y({from:r,to:a,selectValue:e}),I({from:r,to:a,selectValue:e})},disabled:S},(({value:e})=>{var t;return b.default.createElement(b.default.Fragment,null,b.default.createElement(r.Listbox.Button,{onFocus:()=>U(!0),onBlur:()=>U(!1),className:n.tremorTwMerge("w-full outline-none text-left whitespace-nowrap truncate rounded-r-tremor-default transition duration-100 border px-4 py-2","border-tremor-border text-tremor-content-emphasis focus:border-tremor-brand-subtle","dark:border-dark-tremor-border  dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle",d.getSelectButtonColors(d.hasValue(e),S))},e&&null!==(t=A.get(e))&&void 0!==t?t:M),b.default.createElement(r.Transition,{className:"absolute z-10 w-full inset-x-0 right-0",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},b.default.createElement(r.Listbox.Options,{className:n.tremorTwMerge("divide-y overflow-y-auto outline-none border my-1","shadow-tremor-dropdown bg-tremor-background border-tremor-border divide-tremor-border rounded-tremor-default","dark:shadow-dark-tremor-dropdown dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border")},null!=j?j:s.defaultOptions.map((e=>b.default.createElement(i,{key:e.value,value:e.value},e.text))))))})))}));k.displayName="DateRangePicker",module.exports=k;
