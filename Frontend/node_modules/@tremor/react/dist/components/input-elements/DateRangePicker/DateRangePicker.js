'use client';
import{__rest as e}from"tslib";import{Popover as r,Transition as t,Listbox as a}from"@headlessui/react";import o,{useState as n,useMemo as l}from"react";import d from"../../../assets/CalendarIcon.js";import s from"../../../assets/XCircleIcon.js";import{startOfToday as m,startOfMonth as i}from"date-fns";import{tremorTwMerge as u}from"../../../lib/tremorTwMerge.js";import{getNodeText as c,constructValueToNameMapping as b,getSelectButtonColors as f,hasValue as p}from"../selectUtils.js";import{defaultOptions as k,parseStartDate as v,parseEndDate as g,formatSelectedDates as h,makeDateRangePickerClassName as w}from"./dateRangePickerUtils.js";import y from"../Calendar/Calendar.js";import"../Select/Select.js";import x from"../Select/SelectItem.js";import{enUS as N}from"date-fns/locale";import E from"../../../hooks/useInternalState.js";const S=m(),j=o.forwardRef(((m,j)=>{var C,D;const{value:F,defaultValue:V,onValueChange:O,enableSelect:T=!0,minDate:_,maxDate:I,placeholder:P="Select range",selectPlaceholder:z="Select range",disabled:B=!1,locale:M=N,enableClear:R=!0,displayFormat:Y,children:U,className:X,enableYearNavigation:q=!1,weekStartsOn:A=0,disabledDates:G}=m,H=e(m,["value","defaultValue","onValueChange","enableSelect","minDate","maxDate","placeholder","selectPlaceholder","disabled","locale","enableClear","displayFormat","children","className","enableYearNavigation","weekStartsOn","disabledDates"]),[J,K]=E(V,F),[L,Q]=n(!1),[W,Z]=n(!1),$=l((()=>{const e=[];return _&&e.push({before:_}),I&&e.push({after:I}),[...e,...null!=G?G:[]]}),[_,I,G]),ee=l((()=>{const e=new Map;return U?o.Children.forEach(U,(r=>{var t;e.set(r.props.value,{text:null!==(t=c(r))&&void 0!==t?t:r.props.value,from:r.props.from,to:r.props.to})})):k.forEach((r=>{e.set(r.value,{text:r.text,from:r.from,to:S})})),e}),[U]),re=l((()=>{if(U)return b(U);const e=new Map;return k.forEach((r=>e.set(r.value,r.text))),e}),[U]),te=(null==J?void 0:J.selectValue)||"",ae=v(null==J?void 0:J.from,_,te,ee),oe=g(null==J?void 0:J.to,I,te,ee),ne=ae||oe?h(ae,oe,M,Y):P,le=i(null!==(D=null!==(C=null!=oe?oe:ae)&&void 0!==C?C:I)&&void 0!==D?D:S),de=R&&!B;return"development"===process.env.NODE_ENV&&console.info("The DateRangePicker is also available as a copy-and-paste component. Visit https://tremor.so/docs/inputs/date-range-picker (This is only shown in development)"),o.createElement("div",Object.assign({ref:j,className:u("w-full min-w-[10rem] relative flex justify-between text-tremor-default max-w-sm shadow-tremor-input dark:shadow-dark-tremor-input rounded-tremor-default",X)},H),o.createElement(r,{as:"div",className:u("w-full",T?"rounded-l-tremor-default":"rounded-tremor-default",L&&"ring-2 ring-tremor-brand-muted dark:ring-dark-tremor-brand-muted z-10")},o.createElement("div",{className:"relative w-full"},o.createElement(r.Button,{onFocus:()=>Q(!0),onBlur:()=>Q(!1),disabled:B,className:u("w-full outline-none text-left whitespace-nowrap truncate focus:ring-2 transition duration-100 rounded-l-tremor-default flex flex-nowrap border pl-3 py-2","rounded-l-tremor-default border-tremor-border text-tremor-content-emphasis focus:border-tremor-brand-subtle focus:ring-tremor-brand-muted","dark:border-dark-tremor-border dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle dark:focus:ring-dark-tremor-brand-muted",T?"rounded-l-tremor-default":"rounded-tremor-default",de?"pr-8":"pr-4",f(p(ae||oe),B))},o.createElement(d,{className:u(w("calendarIcon"),"flex-none shrink-0 h-5 w-5 -ml-0.5 mr-2","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle"),"aria-hidden":"true"}),o.createElement("p",{className:"truncate"},ne)),de&&ae?o.createElement("button",{type:"button",className:u("absolute outline-none inset-y-0 right-0 flex items-center transition duration-100 mr-4"),onClick:e=>{e.preventDefault(),null==O||O({}),K({})}},o.createElement(s,{className:u(w("clearIcon"),"flex-none h-4 w-4","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle")})):null),o.createElement(t,{className:"absolute z-10 min-w-min left-0",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},o.createElement(r.Panel,{focus:!0,className:u("divide-y overflow-y-auto outline-none rounded-tremor-default p-3 border my-1","bg-tremor-background border-tremor-border divide-tremor-border shadow-tremor-dropdown","dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border dark:shadow-dark-tremor-dropdown")},o.createElement(y,Object.assign({mode:"range",showOutsideDays:!0,defaultMonth:le,selected:{from:ae,to:oe},onSelect:e=>{null==O||O({from:null==e?void 0:e.from,to:null==e?void 0:e.to}),K({from:null==e?void 0:e.from,to:null==e?void 0:e.to})},locale:M,disabled:$,enableYearNavigation:q,classNames:{day_range_middle:u("!rounded-none aria-selected:!bg-tremor-background-subtle aria-selected:dark:!bg-dark-tremor-background-subtle aria-selected:!text-tremor-content aria-selected:dark:!bg-dark-tremor-background-subtle"),day_range_start:"rounded-r-none rounded-l-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted",day_range_end:"rounded-l-none rounded-r-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted"},weekStartsOn:A},m))))),T&&o.createElement(a,{as:"div",className:u("w-48 -ml-px rounded-r-tremor-default",W&&"ring-2 ring-tremor-brand-muted dark:ring-dark-tremor-brand-muted z-10"),value:te,onChange:e=>{const{from:r,to:t}=ee.get(e),a=null!=t?t:S;null==O||O({from:r,to:a,selectValue:e}),K({from:r,to:a,selectValue:e})},disabled:B},(({value:e})=>{var r;return o.createElement(o.Fragment,null,o.createElement(a.Button,{onFocus:()=>Z(!0),onBlur:()=>Z(!1),className:u("w-full outline-none text-left whitespace-nowrap truncate rounded-r-tremor-default transition duration-100 border px-4 py-2","border-tremor-border text-tremor-content-emphasis focus:border-tremor-brand-subtle","dark:border-dark-tremor-border  dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle",f(p(e),B))},e&&null!==(r=re.get(e))&&void 0!==r?r:z),o.createElement(t,{className:"absolute z-10 w-full inset-x-0 right-0",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},o.createElement(a.Options,{className:u("divide-y overflow-y-auto outline-none border my-1","shadow-tremor-dropdown bg-tremor-background border-tremor-border divide-tremor-border rounded-tremor-default","dark:shadow-dark-tremor-dropdown dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border")},null!=U?U:k.map((e=>o.createElement(x,{key:e.value,value:e.value},e.text))))))})))}));j.displayName="DateRangePicker";export{j as default};
