import{__rest as e}from"tslib";import t,{useCallback as r,useEffect as l}from"react";import{colorPalette as o,themeColorRange as n}from"../../../lib/theme.js";import{tremorTwMerge as a}from"../../../lib/tremorTwMerge.js";import{makeClassName as c,getColorClassNames as i}from"../../../lib/utils.js";import s from"../../../assets/ChevronLeftFill.js";import u from"../../../assets/ChevronRightFill.js";const d=c("Legend"),m=({name:e,color:r,onClick:l,activeLegend:n})=>{const c=!!l;return t.createElement("li",{className:a(d("legendItem"),"group inline-flex items-center px-2 py-0.5 rounded-tremor-small transition whitespace-nowrap",c?"cursor-pointer":"cursor-default","text-tremor-content",c?"hover:bg-tremor-background-subtle":"","dark:text-dark-tremor-content",c?"dark:hover:bg-dark-tremor-background-subtle":""),onClick:t=>{t.stopPropagation(),null==l||l(e,r)}},t.createElement("svg",{className:a("flex-none h-2 w-2 mr-1.5",i(r,o.text).textColor,n&&n!==e?"opacity-40":"opacity-100"),fill:"currentColor",viewBox:"0 0 8 8"},t.createElement("circle",{cx:4,cy:4,r:4})),t.createElement("p",{className:a("whitespace-nowrap truncate text-tremor-default","text-tremor-content",c?"group-hover:text-tremor-content-emphasis":"","dark:text-dark-tremor-content",n&&n!==e?"opacity-40":"opacity-100",c?"dark:group-hover:text-dark-tremor-content-emphasis":"")},e))},f=({icon:e,onClick:r,disabled:o})=>{const n=e,[c,i]=t.useState(!1),s=t.useRef(null);return t.useEffect((()=>(c?s.current=setInterval((()=>{null==r||r()}),300):clearInterval(s.current),()=>clearInterval(s.current))),[c,r]),l((()=>{o&&(clearInterval(s.current),i(!1))}),[o]),t.createElement("button",{type:"button",className:a(d("legendSliderButton"),"w-5 group inline-flex items-center truncate rounded-tremor-small transition",o?"cursor-not-allowed":"cursor-pointer",o?"text-tremor-content-subtle":"text-tremor-content hover:text-tremor-content-emphasis hover:bg-tremor-background-subtle",o?"dark:text-dark-tremor-subtle":"dark:text-dark-tremor dark:hover:text-tremor-content-emphasis dark:hover:bg-dark-tremor-background-subtle"),disabled:o,onClick:e=>{e.stopPropagation(),null==r||r()},onMouseDown:e=>{e.stopPropagation(),i(!0)},onMouseUp:e=>{e.stopPropagation(),i(!1)}},t.createElement(n,{className:"w-full"}))},p=t.forwardRef(((l,o)=>{var c,i;const{categories:p,colors:v=n,className:g,onClickLegendItem:k,activeLegend:h,enableLegendSlider:b=!1}=l,x=e(l,["categories","colors","className","onClickLegendItem","activeLegend","enableLegendSlider"]),w=t.useRef(null),L=t.useRef(null),[E,y]=t.useState(null),[C,I]=t.useState(null),N=t.useRef(null),R=r((()=>{const e=null==w?void 0:w.current;if(!e)return;const t=e.scrollLeft>0,r=e.scrollWidth-e.clientWidth>e.scrollLeft;y({left:t,right:r})}),[y]),j=r((e=>{var t,r;const l=null==w?void 0:w.current,o=null==L?void 0:L.current,n=null!==(t=null==l?void 0:l.clientWidth)&&void 0!==t?t:0,a=null!==(r=null==o?void 0:o.clientWidth)&&void 0!==r?r:0;l&&b&&(l.scrollTo({left:"left"===e?l.scrollLeft-n+a:l.scrollLeft+n-a,behavior:"smooth"}),setTimeout((()=>{R()}),400))}),[b,R]);t.useEffect((()=>{const e=e=>{"ArrowLeft"===e?j("left"):"ArrowRight"===e&&j("right")};return C?(e(C),N.current=setInterval((()=>{e(C)}),300)):clearInterval(N.current),()=>clearInterval(N.current)}),[C,j]);const P=e=>{e.stopPropagation(),"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||(e.preventDefault(),I(e.key))},S=e=>{e.stopPropagation(),I(null)};return t.useEffect((()=>{const e=null==w?void 0:w.current;return b&&(R(),null==e||e.addEventListener("keydown",P),null==e||e.addEventListener("keyup",S)),()=>{null==e||e.removeEventListener("keydown",P),null==e||e.removeEventListener("keyup",S)}}),[R,b]),t.createElement("ol",Object.assign({ref:o,className:a(d("root"),"relative overflow-hidden",g)},x),t.createElement("div",{ref:w,tabIndex:0,className:a("h-full flex",b?(null==E?void 0:E.right)||(null==E?void 0:E.left)?"pl-4 pr-12  items-center overflow-auto snap-mandatory [&::-webkit-scrollbar]:hidden [scrollbar-width:none]":"":"flex-wrap")},p.map(((e,r)=>t.createElement(m,{key:`item-${r}`,name:e,color:v[r%v.length],onClick:k,activeLegend:h})))),b&&((null==E?void 0:E.right)||(null==E?void 0:E.left))?t.createElement(t.Fragment,null,t.createElement("div",{className:a("bg-tremor-background","dark:bg-dark-tremor-background","absolute flex top-0 pr-1 bottom-0 right-0 items-center justify-center h-full"),ref:L},t.createElement(f,{icon:s,onClick:()=>{I(null),j("left")},disabled:null===(c=!(null==E?void 0:E.left))||void 0===c||c}),t.createElement(f,{icon:u,onClick:()=>{I(null),j("right")},disabled:null===(i=!(null==E?void 0:E.right))||void 0===i||i}))):null)}));p.displayName="Legend";export{p as default};
